<?php

/* ----------------------------------------------------------------------------------------------
 * FILE INFORMATION
 * ----------------------------------------------------------------------------------------------
 *
 * FILE: index.php
 *
 * LOCATION: ./index.php
 *
 * Contains global settings for the application.
 */


/* ----------------------------------------------------------------------------------------------
 * Initialize
 * ----------------------------------------------------------------------------------------------
 *
 */



try {

	/* ----------------------------------------------------------------------------------------------
	 * Autoloader
	 * ----------------------------------------------------------------------------------------------
	 *
	 * Include the Autoloader class to handle the use of libraries.
	 */

	require_once 'vendor/autoload.php';



	/* ----------------------------------------------------------------------------------------------
	 * Request object
	 * ----------------------------------------------------------------------------------------------
	 *
	 */

	$request = new Request();
	Http::$request = $request;



	/* ----------------------------------------------------------------------------------------------
	 * Set path constants
	 * ----------------------------------------------------------------------------------------------
	 *
	 * Set path constants for some folders.
	 */

	define('SYSTEM',    'system/');
	define('APP',       'app/');
	define('VERSION_FOLDER', APP . 'version_' . $request->url->version . '/');
	define('RESOURCES',    VERSION_FOLDER . 'resources/');
	define('CONFIG', 	VERSION_FOLDER . 'config/');



	/* ----------------------------------------------------------------------------------------------
	 * Database
	 * ----------------------------------------------------------------------------------------------
	 *
	 * Connect to the datbase using the Database class
	 */

	$connections = Config::get('database', 'connections');

	Database::connect($connections['mysql']);

	

	/* ----------------------------------------------------------------------------------------------
	 * Response object
	 * ----------------------------------------------------------------------------------------------
	 *
	 */

	$response = new Response();
	Http::$response = $response;



	/* ----------------------------------------------------------------------------------------------
	 * Router
	 * ----------------------------------------------------------------------------------------------
	 *
	 */

	$router = new Router(Http::$request->url->version,
						 Http::$request->url->resource,
						 Http::$request->url->id,
						 Http::$request->url->slug);
	

} catch(Exception $e) {
	Http::$response->status(500);
}